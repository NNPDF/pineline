# Set up

## Setting up *PINEKO*

In order to make *PINEKO* ready to generate FK tables, it is necessary to set up 
some folders according to the file `pineko.toml`. This file provides the paths to 
all the relevant directories that *pineko* will use. An example of such file is
```yaml
    [paths]
    # inputs
    ymldb = "data/yamldb"
    grids = "data/grids"
    theory_cards = "data/theory_cards"
    operator_card_template = "data/operator_cards/_template.yaml"
    # outputs
    operator_cards = "data/operator_cards"
    ekos = "data/ekos"
    fktables = "data/fktables"

    [paths.logs]
    eko = "logs/eko"
    fk = "logs/fk"
```
### Inputs
The inputs that *pineko* needs are listed in the `#inputs` part of the `pineko.toml`
file. They are:
- The `yaml` files contained in the folder `data/yamldb`. They provide the mapping between 
the name of the FK table to be computed and the necessary grids. 
- The `theory_cards` contained in the folder `data/theory_cards`. They provide the different 
physics parameter to be used to compute the FK table. 
- The `grids` contained in the folder `data/grids/<theory_number>`, where `<theory_number>`
is the number of the theory card that we want to use. They are the objects that *PINEKO* 
convolutes with the *EKOs* to produce FK tables and they can be computed using *PINEFARM*. 
- The `template` operator card that provides some of the inputs needed by *EKO* and some 
placeholders to be filled by *PINEKO*. 

An example of a rather simple `yaml` file for the dataset `HERACOMBNCEP460` is the following
```yaml
    conversion_factor: 1.0
    operands:
    - - HERA_NC_225GEV_EP_SIGMARED
    operation: 'null'
    target_dataset: HERACOMBNCEP460
```
while an example of a **NLO** theory card is  
```yaml
    CKM: 0.97428 0.22530 0.003470 0.22520 0.97345 0.041000 0.00862 0.04030 0.999152
    Comments: NNPDF4.0 NLO alphas=0.118
    DAMP: 0
    EScaleVar: 1
    FNS: FONLL-B
    GF: 1.1663787e-05
    HQ: POLE
    IB: 0
    IC: 1
    ID: 208
    MP: 0.938
    MW: 80.398
    MZ: 91.1876
    MaxNfAs: 5
    MaxNfPdf: 5
    ModEv: TRN
    ModSV: expanded
    NfFF: 4
    PTO: 1
    Q0: 1.65
    QED: 0
    Qedref: 1.777
    Qmb: 4.92
    Qmc: 1.51
    Qmt: 172.5
    Qref: 91.2
    SIN2TW: 0.23126
    SxOrd: LL
    SxRes: 0
    TMC: 1
    XIF: 1.0
    XIR: 1.0
    alphaqed: 0.007496252
    alphas: 0.118
    fact_to_ren_scale_ratio: 1.0
    global_nx: 0
    kbThr: 1.0
    kcThr: 1.0
    ktThr: 1.0
    mb: 4.92
    mc: 1.51
    mt: 172.5
    nfref: null
    nf0: null
    kDISbThr: 1.0
    kDIScThr: 1.0
    kDIStThr: 1.0
```
The default operator card `template` is 
```yaml
    ev_op_max_order: 10
    ev_op_iterations: 1
    n_integration_cores: 6
    backward_inversion: "exact"
    Q2grid: [50.]
    interpolation_is_log: True
    interpolation_polynomial_degree: 4
    interpolation_xgrid:
    - 1.9999999999999954e-07
    - 3.034304765867952e-07
    - 4.6035014748963906e-07
    - 6.984208530700364e-07
    - 1.0596094959101024e-06
    - 1.607585498470808e-06
    - 2.438943292891682e-06
    - 3.7002272069854957e-06
    - 5.613757716930151e-06
    - 8.516806677573355e-06
    - 1.292101569074731e-05
    - 1.9602505002391748e-05
    - 2.97384953722449e-05
    - 4.511438394964044e-05
    - 6.843744918967896e-05
    - 0.00010381172986576898
    - 0.00015745605600841445
    - 0.00023878782918561914
    - 0.00036205449638139736
    - 0.0005487795323670796
    - 0.0008314068836488144
    - 0.0012586797144272762
    - 0.0019034634022867384
    - 0.0028738675812817515
    - 0.004328500638820811
    - 0.006496206194633799
    - 0.009699159574043398
    - 0.014375068581090129
    - 0.02108918668378717
    - 0.030521584007828916
    - 0.04341491741702269
    - 0.060480028754447364
    - 0.08228122126204893
    - 0.10914375746330703
    - 0.14112080644440345
    - 0.17802566042569432
    - 0.2195041265003886
    - 0.2651137041582823
    - 0.31438740076927585
    - 0.3668753186482242
    - 0.4221667753589648
    - 0.4798989029610255
    - 0.5397572337880445
    - 0.601472197967335
    - 0.6648139482473823
    - 0.7295868442414312
    - 0.7956242522922756
    - 0.8627839323906108
    - 0.9309440808717544
    - 1
    debug_skip_non_singlet: False
    debug_skip_singlet: False
```

For additional details about the set up of *PINEKO* and about the different ingredients
please refer to the `prerequisites` part of the 
[PINEKO documentation](https://pineko.readthedocs.io/en/latest/overview/prerequisites.html).

### Outputs
*PINEKO* provides three kinds of outputs:
- The `operator cards`.
- The `ekos`.
- The `FK tables`.

The `operator cards` are the runcards of *EKO*. Then, they are needed by *EKO*, together with the `theory cards`,
to produce the `eko` operators to be convoluted with the `grids`. *PINEKO* automatically writes 
the relevant `operator card` for the requested dataset using the provided `template` and `grid`. 
An example of such runcard for the dataset `HERACOMBNCEP460` is 
```yaml
    Q2grid:
    - 2.0
    - 2.5
    - 3.5
    - 5.0
    - 6.5
    - 8.5
    - 12.0
    - 15.0
    - 20.0
    - 25.0
    - 35.0
    - 45.0
    - 60.0
    - 90.0
    - 120.0
    - 150.0
    - 200.0
    - 250.0
    - 300.0
    - 400.0
    - 500.0
    - 650.0
    - 800.0
    backward_inversion: exact
    debug_skip_non_singlet: false
    debug_skip_singlet: false
    ev_op_iterations: 1
    ev_op_max_order: 10
    interpolation_is_log: true
    interpolation_polynomial_degree: 4
    interpolation_xgrid:
    - 1.9999999999999954e-07
    - 3.034304765867952e-07
    - 4.6035014748963906e-07
    - 6.984208530700364e-07
    - 1.0596094959101024e-06
    - 1.607585498470808e-06
    - 2.438943292891682e-06
    - 3.7002272069854957e-06
    - 5.613757716930151e-06
    - 8.516806677573355e-06
    - 1.292101569074731e-05
    - 1.9602505002391748e-05
    - 2.97384953722449e-05
    - 4.511438394964044e-05
    - 6.843744918967896e-05
    - 0.00010381172986576898
    - 0.00015745605600841445
    - 0.00023878782918561914
    - 0.00036205449638139736
    - 0.0005487795323670796
    - 0.0008314068836488144
    - 0.0012586797144272762
    - 0.0019034634022867384
    - 0.0028738675812817515
    - 0.004328500638820811
    - 0.006496206194633799
    - 0.009699159574043398
    - 0.014375068581090129
    - 0.02108918668378717
    - 0.030521584007828916
    - 0.04341491741702269
    - 0.060480028754447364
    - 0.08228122126204893
    - 0.10914375746330703
    - 0.14112080644440345
    - 0.17802566042569432
    - 0.2195041265003886
    - 0.2651137041582823
    - 0.31438740076927585
    - 0.3668753186482242
    - 0.4221667753589648
    - 0.4798989029610255
    - 0.5397572337880445
    - 0.601472197967335
    - 0.6648139482473823
    - 0.7295868442414312
    - 0.7956242522922756
    - 0.8627839323906108
    - 0.9309440808717544
    - 1
    n_integration_cores: 6
    targetgrid:
    - 1.9999999999999954e-07
    - 3.034304765867952e-07
    - 4.6035014748963906e-07
    - 6.984208530700364e-07
    - 1.0596094959101024e-06
    - 1.607585498470808e-06
    - 2.438943292891682e-06
    - 3.7002272069854957e-06
    - 5.613757716930151e-06
    - 8.516806677573355e-06
    - 1.292101569074731e-05
    - 1.9602505002391748e-05
    - 2.97384953722449e-05
    - 4.511438394964044e-05
    - 6.843744918967896e-05
    - 0.00010381172986576898
    - 0.00015745605600841445
    - 0.00023878782918561914
    - 0.00036205449638139736
    - 0.0005487795323670796
    - 0.0008314068836488144
    - 0.0012586797144272762
    - 0.0019034634022867384
    - 0.0028738675812817515
    - 0.004328500638820811
    - 0.006496206194633799
    - 0.009699159574043398
    - 0.014375068581090129
    - 0.02108918668378717
    - 0.030521584007828916
    - 0.04341491741702269
    - 0.060480028754447364
    - 0.08228122126204893
    - 0.10914375746330703
    - 0.14112080644440345
    - 0.17802566042569432
    - 0.2195041265003886
    - 0.2651137041582823
    - 0.31438740076927585
    - 0.3668753186482242
    - 0.4221667753589648
    - 0.4798989029610255
    - 0.5397572337880445
    - 0.601472197967335
    - 0.6648139482473823
    - 0.7295868442414312
    - 0.7956242522922756
    - 0.8627839323906108
    - 0.9309440808717544
    - 1.0
```

The `ekos` are the operators produced by *EKO* that provide the evolution of the grid. 
For more informations about the `eko` operators please refer to the 
[EKO documentation](https://eko.readthedocs.io/en/latest/).
The `FK tables` are the final product of *PINEKO* while the `ekos` and `operator cards` are just
used internally by *PINEKO* and thus they are usually not relevant for the user. 

### Logs 
Setting up the `logs` folders is optional but can be very handy in order to spot possible
bugs and/or failures.



